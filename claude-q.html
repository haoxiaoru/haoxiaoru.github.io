<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>和弦的世界：从基础到变化</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
    <style>
        :root {
            --primary: #2d3748;
            --secondary: #4a5568;
            --accent: #6b46c1;
            --accent-light: #9f7aea;
            --light: #f7fafc;
            --dark: #1a202c;
            --success: #48bb78;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            color: var(--primary);
            background-color: var(--light);
            line-height: 1.6;
            max-width: 100vw;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
        
        header {
            padding: 2rem 0;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }
        
        h2 {
            font-size: 1.8rem;
            margin: 2rem 0 1rem;
            color: var(--accent);
            border-bottom: 2px solid var(--accent-light);
            padding-bottom: 0.5rem;
        }
        
        h3 {
            font-size: 1.4rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--secondary);
        }
        
        p {
            margin-bottom: 1.2rem;
        }
        
        .sidebar {
            width: 280px;
            position: sticky;
            top: 2rem;
            height: calc(100vh - 4rem);
            overflow-y: auto;
            padding-right: 1.5rem;
            display: block;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
        }
        
        .content {
            flex: 1;
            min-width: 0;
        }
        
        .toc {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
        }
        
        .toc h3 {
            margin-top: 0;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc ul li {
            margin-bottom: 0.75rem;
        }
        
        .toc ul li a {
            text-decoration: none;
            color: var(--secondary);
            transition: color 0.2s;
            display: block;
            padding: 0.25rem 0;
        }
        
        .toc ul li a:hover {
            color: var(--accent);
        }
        
        .toc ul li ul {
            margin-top: 0.5rem;
            margin-left: 1rem;
        }
        
        .chart-container {
            width: 100%;
            height: 400px;
            margin: 2rem 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .chord-display {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin: 2rem 0;
            justify-content: center;
        }
        
        .chord-card {
            width: 180px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 1rem;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .chord-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .chord-name {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }
        
        .chord-formula {
            color: var(--secondary);
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }
        
        .chord-visual {
            height: 80px;
            margin: 0 auto;
            position: relative;
        }
        
        .piano-key {
            position: absolute;
            bottom: 0;
            border-radius: 0 0 3px 3px;
        }
        
        .white-key {
            width: 16px;
            height: 80px;
            background: white;
            border: 1px solid #ddd;
        }
        
        .black-key {
            width: 10px;
            height: 50px;
            background: #333;
            z-index: 1;
        }
        
        .key-active {
            background: var(--accent-light);
        }
        
        .black-key.key-active {
            background: var(--accent);
        }
        
        .chord-examples {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--secondary);
        }
        
        .interactive-chord-builder {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--secondary);
        }
        
        select, button {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            background: white;
            font-size: 1rem;
        }
        
        button {
            background: var(--accent);
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        button:hover {
            background: var(--accent-light);
        }
        
        .result {
            margin-top: 1.5rem;
            text-align: center;
        }
        
        .piano-display {
            height: 120px;
            width: 100%;
            position: relative;
            margin: 1.5rem 0;
        }
        
        .quiz-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .question {
            margin-bottom: 1.5rem;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .option {
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .option:hover {
            background: #f7fafc;
        }
        
        .option.selected {
            border-color: var(--accent);
            background: rgba(159, 122, 234, 0.1);
        }
        
        .feedback {
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            display: none;
        }
        
        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
            display: block;
        }
        
        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            border: 1px solid #f56565;
            color: #c53030;
            display: block;
        }
        
        .reward {
            background: linear-gradient(135deg, #805ad5, #6b46c1);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            color: white;
            margin-top: 2rem;
            box-shadow: 0 10px 15px rgba(107, 70, 193, 0.2);
            transform: scale(0);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .reward.show {
            transform: scale(1);
        }
        
        .reward h3 {
            color: white;
            margin-top: 0;
        }
        
        .note-example {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }
        
        .note {
            text-align: center;
            margin: 0 0.5rem;
        }
        
        .note-name {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }
        
        @keyframes highlight {
            0% { background: var(--accent-light); }
            100% { background: transparent; }
        }
        
        .highlight {
            animation: highlight 2s ease-out;
        }
    </style>
</head>
<body>
    <header>
        <h1>和弦的世界：从基础到变化</h1>
        <p>探索音乐理论中的和声构建与表现</p>
    </header>
    
    <div class="container">
        <aside class="sidebar">
            <div class="toc">
                <h3>目录</h3>
                <ul>
                    <li><a href="#intro">和弦的定义与概念</a></li>
                    <li><a href="#structure">和弦的构成要素</a></li>
                    <li>
                        <a href="#types">和弦的主要类型</a>
                        <ul>
                            <li><a href="#triads">三和弦</a></li>
                            <li><a href="#seventh">七和弦</a></li>
                            <li><a href="#extended">扩展和弦</a></li>
                            <li><a href="#altered">变化和弦</a></li>
                        </ul>
                    </li>
                    <li><a href="#functions">和弦的功能与进行</a></li>
                    <li><a href="#interactive">互动和弦构建器</a></li>
                    <li><a href="#quiz">和弦知识小测验</a></li>
                    <li><a href="#conclusion">总结</a></li>
                </ul>
            </div>
        </aside>
        
        <main class="content">
            <section id="intro">
                <h2>和弦的定义与概念</h2>
                <p>和弦（Chord）是指三个或更多不同音高的音符同时发声而产生的组合。它是西方音乐和声系统的基础，不仅为旋律提供支撑，也能独立表达丰富的音乐情感。和弦的概念可以追溯到中世纪的多声部音乐，但直到巴洛克时期才开始形成完整的和声理论。</p>
                
                <p>在现代音乐理论中，和弦通常被视为音乐的"垂直"结构，而旋律则是"水平"结构。这两个元素的交织构成了音乐的织体。和弦能够创造出特定的情绪氛围和音乐色彩，是作曲、即兴演奏和音乐分析的重要工具。</p>
                
                <div class="chart-container" id="chord-intro-chart"></div>
            </section>
            
            <section id="structure">
                <h2>和弦的构成要素</h2>
                <p>和弦的构成基于音程关系。在西方音乐中，最基本的音高组织是以十二平均律为基础的，一个八度被均分为12个半音：</p>
                
                <div class="note-example">
                    <div class="note"><div class="note-name">C</div><div>1</div></div>
                    <div class="note"><div class="note-name">C♯/D♭</div><div>2</div></div>
                    <div class="note"><div class="note-name">D</div><div>3</div></div>
                    <div class="note"><div class="note-name">D♯/E♭</div><div>4</div></div>
                    <div class="note"><div class="note-name">E</div><div>5</div></div>
                    <div class="note"><div class="note-name">F</div><div>6</div></div>
                    <div class="note"><div class="note-name">F♯/G♭</div><div>7</div></div>
                    <div class="note"><div class="note-name">G</div><div>8</div></div>
                    <div class="note"><div class="note-name">G♯/A♭</div><div>9</div></div>
                    <div class="note"><div class="note-name">A</div><div>10</div></div>
                    <div class="note"><div class="note-name">A♯/B♭</div><div>11</div></div>
                    <div class="note"><div class="note-name">B</div><div>12</div></div>
                </div>
                
                <p>和弦的构成要素主要包括：</p>
                <ul>
                    <li><strong>根音（Root）</strong>：和弦的基础音，通常是和弦名称的来源</li>
                    <li><strong>音程（Intervals）</strong>：和弦中各音与根音的距离关系</li>
                    <li><strong>和弦结构（Structure）</strong>：音程的组合方式</li>
                    <li><strong>和弦转位（Inversion）</strong>：通过改变最低音来重新排列和弦音的方式</li>
                </ul>
                
                <p>和弦通常按照三度堆叠的方式构建（即隔一个音进行堆叠），这是西方和声系统的核心原则。例如，C大三和弦由C（根音）、E（大三度）和G（纯五度）组成。</p>
                
                <div class="chart-container" id="interval-chart"></div>
            </section>
            
            <section id="types">
                <h2>和弦的主要类型</h2>
                <p>和弦的种类极其丰富，基于不同的理论体系和音乐风格，可以有数百种不同的和弦类型。以下是按照复杂程度划分的主要和弦类型：</p>
                
                <section id="triads">
                    <h3>三和弦 (Triads)</h3>
                    <p>三和弦是最基本的和弦类型，由三个音组成，通常是根音、三度和五度。根据三度和五度的类型，形成四种基本三和弦：</p>
                    
                    <div class="chord-display">
                        <div class="chord-card" id="major-triad">
                            <div class="chord-name">大三和弦</div>
                            <div class="chord-formula">1 - 3 - 5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C (C-E-G)</div>
                        </div>
                        
                        <div class="chord-card" id="minor-triad">
                            <div class="chord-name">小三和弦</div>
                            <div class="chord-formula">1 - ♭3 - 5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Cm (C-E♭-G)</div>
                        </div>
                        
                        <div class="chord-card" id="diminished-triad">
                            <div class="chord-name">减三和弦</div>
                            <div class="chord-formula">1 - ♭3 - ♭5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C° (C-E♭-G♭)</div>
                        </div>
                        
                        <div class="chord-card" id="augmented-triad">
                            <div class="chord-name">增三和弦</div>
                            <div class="chord-formula">1 - 3 - ♯5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C+ (C-E-G♯)</div>
                        </div>
                    </div>
                </section>
                
                <section id="seventh">
                    <h3>七和弦 (Seventh Chords)</h3>
                    <p>七和弦是在三和弦的基础上加入第七音形成的四音和弦，增加了和声的丰富性和张力。常见的七和弦包括：</p>
                    
                    <div class="chord-display">
                        <div class="chord-card" id="dominant-seventh">
                            <div class="chord-name">属七和弦</div>
                            <div class="chord-formula">1 - 3 - 5 - ♭7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C7 (C-E-G-B♭)</div>
                        </div>
                        
                        <div class="chord-card" id="major-seventh">
                            <div class="chord-name">大七和弦</div>
                            <div class="chord-formula">1 - 3 - 5 - 7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Cmaj7 (C-E-G-B)</div>
                        </div>
                        
                        <div class="chord-card" id="minor-seventh">
                            <div class="chord-name">小七和弦</div>
                            <div class="chord-formula">1 - ♭3 - 5 - ♭7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Cm7 (C-E♭-G-B♭)</div>
                        </div>
                        
                        <div class="chord-card" id="half-diminished">
                            <div class="chord-name">半减七和弦</div>
                            <div class="chord-formula">1 - ♭3 - ♭5 - ♭7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Cø (C-E♭-G♭-B♭)</div>
                        </div>
                        
                        <div class="chord-card" id="diminished-seventh">
                            <div class="chord-name">减七和弦</div>
                            <div class="chord-formula">1 - ♭3 - ♭5 - ♭♭7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C°7 (C-E♭-G♭-A)</div>
                        </div>
                        
                        <div class="chord-card" id="minor-major-seventh">
                            <div class="chord-name">小大七和弦</div>
                            <div class="chord-formula">1 - ♭3 - 5 - 7</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：CmM7 (C-E♭-G-B)</div>
                        </div>
                    </div>
                </section>
                
                <section id="extended">
                    <h3>扩展和弦 (Extended Chords)</h3>
                    <p>扩展和弦是在七和弦基础上继续堆叠三度音程，形成九和弦、十一和弦和十三和弦。这些和弦常用于爵士、融合、R&B等音乐风格中，增加了和声的复杂性和色彩：</p>
                    
                    <div class="chord-display">
                        <div class="chord-card" id="ninth-chord">
                            <div class="chord-name">九和弦</div>
                            <div class="chord-formula">1-3-5-♭7-9</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C9 (C-E-G-B♭-D)</div>
                        </div>
                        
                        <div class="chord-card" id="eleventh-chord">
                            <div class="chord-name">十一和弦</div>
                            <div class="chord-formula">1-3-5-♭7-9-11</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C11 (C-E-G-B♭-D-F)</div>
                        </div>
                        
                        <div class="chord-card" id="thirteenth-chord">
                            <div class="chord-name">十三和弦</div>
                            <div class="chord-formula">1-3-5-♭7-9-11-13</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C13 (C-E-G-B♭-D-F-A)</div>
                        </div>
                    </div>
                    
                    <p>实际演奏中，扩展和弦往往会省略某些音以避免音响过于浑浊，但保留其特征音色。</p>
                </section>
                
                <section id="altered">
                    <h3>变化和弦 (Altered Chords)</h3>
                    <p>变化和弦是通过改变和弦中的某些音程（通常是第五、第九、第十一或第十三音）创造出更具张力的和声。常见于爵士和现代和声中：</p>
                    
                    <div class="chord-display">
                        <div class="chord-card" id="sus4">
                            <div class="chord-name">挂四和弦</div>
                            <div class="chord-formula">1 - 4 - 5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Csus4 (C-F-G)</div>
                        </div>
                        
                        <div class="chord-card" id="sus2">
                            <div class="chord-name">挂二和弦</div>
                            <div class="chord-formula">1 - 2 - 5</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Csus2 (C-D-G)</div>
                        </div>
                        
                        <div class="chord-card" id="add9">
                            <div class="chord-name">加九和弦</div>
                            <div class="chord-formula">1 - 3 - 5 - 9</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：Cadd9 (C-E-G-D)</div>
                        </div>
                        
                        <div class="chord-card" id="sixth">
                            <div class="chord-name">六和弦</div>
                            <div class="chord-formula">1 - 3 - 5 - 6</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C6 (C-E-G-A)</div>
                        </div>
                        
                        <div class="chord-card" id="altered-dominant">
                            <div class="chord-name">变化属和弦</div>
                            <div class="chord-formula">1 - 3 - ♭5/♯5 - ♭7 - ♭9/♯9</div>
                            <div class="chord-visual"></div>
                            <div class="chord-examples">如：C7alt (C-E-G♭-B♭-D♭)</div>
                        </div>
                    </div>
                </section>
                
                <p>除了上述主要类型，还有许多复合和弦、多调性和弦、集群和弦等更复杂的和弦类型，广泛应用于现代音乐创作中。综合起来，理论上可以形成的和弦类型数以千计，但实际音乐中常用的和弦类型约有几百种。</p>
                
                <div class="chart-container" id="chord-stats-chart"></div>
            </section>
            
            <section id="functions">
                <h2>和弦的功能与进行</h2>
                <p>和弦不仅是静态的音的组合，更重要的是它们在音乐中的功能和相互关系。在调性音乐中，和弦具有不同的功能角色：</p>
                
                <ul>
                    <li><strong>主和弦（Tonic）</strong>：提供稳定感和归属感，通常是乐曲的起点和终点</li>
                    <li><strong>属和弦（Dominant）</strong>：创造张力和指向性，通常解决到主和弦</li>
                    <li><strong>下属和弦（Subdominant）</strong>：连接主和弦与属和弦，提供和声变化</li>
                </ul>
                
                <p>和弦进行是多个和弦按一定规则连接的序列，形成音乐的和声骨架。经典的和弦进行包括：</p>
                
                <ul>
                    <li><strong>I-IV-V-I</strong>：最基本的调性进行，体现主-下属-属-主的功能循环</li>
                    <li><strong>I-vi-IV-V</strong>：流行音乐中常见的进行</li>
                    <li><strong>ii-V-I</strong>：爵士音乐中的标志性进行</li>
                </ul>
                
                <div class="chart-container" id="progression-chart"></div>
                
                <p>和弦进行可以创造出音乐的情感流动，从紧张到放松，从期待到满足，是音乐叙事的重要手段。</p>
            </section>
            
            <section id="interactive">
                <h2>互动和弦构建器</h2>
                <div class="interactive-chord-builder">
                    <div class="controls">
                        <div class="control-group">
                            <label for="root-note">根音</label>
                            <select id="root-note">
                                <option value="0">C</option>
                                <option value="1">C♯/D♭</option>
                                <option value="2">D</option>
                                <option value="3">D♯/E♭</option>
                                <option value="4">E</option>
                                <option value="5">F</option>
                                <option value="6">F♯/G♭</option>
                                <option value="7">G</option>
                                <option value="8">G♯/A♭</option>
                                <option value="9">A</option>
                                <option value="10">A♯/B♭</option>
                                <option value="11">B</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="chord-type">和弦类型</label>
                            <select id="chord-type">
                                <option value="major">大三和弦</option>
                                <option value="minor">小三和弦</option>
                                <option value="diminished">减三和弦</option>
                                <option value="augmented">增三和弦</option>
                                <option value="dom7">属七和弦</option>
                                <option value="maj7">大七和弦</option>
                                <option value="min7">小七和弦</option>
                                <option value="sus4">挂四和弦</option>
                                <option value="add9">加九和弦</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="inversion">转位</label>
                            <select id="inversion">
                                <option value="0">原位</option>
                                <option value="1">第一转位</option>
                                <option value="2">第二转位</option>
                                <option value="3">第三转位</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label>&nbsp;</label>
                            <button id="build-chord">生成和弦</button>
                        </div>
                    </div>
                    
                    <div class="piano-display" id="interactive-piano"></div>
                    
                    <div class="result">
                        <h3>和弦结果</h3>
                        <p id="chord-result">选择参数并点击"生成和弦"按钮</p>
                    </div>
                </div>
            </section>
            
            <section id="quiz">
                <h2>和弦知识小测验</h2>
                <div class="quiz-container">
                    <div class="question">
                        <h3>问题：以下哪个和弦是由根音、小三度和纯五度组成的？</h3>
                        <div class="options">
                            <div class="option" data-correct="false">大三和弦</div>
                            <div class="option" data-correct="true">小三和弦</div>
                            <div class="option" data-correct="false">减三和弦</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <button id="check-answer">提交答案</button>
                    
                    <div class="reward" id="reward">
                        <h3>恭喜你答对了！</h3>
                        <p>小三和弦是由根音、小三度（♭3）和纯五度（5）构成的，如C小三和弦：C-E♭-G。</p>
                        <p>小三和弦通常给人以柔和、忧伤或内敛的感觉，在古典音乐、流行音乐和爵士乐等多种风格中都有广泛应用。</p>
                    </div>
                </div>
            </section>
            
            <section id="conclusion">
                <h2>总结</h2>
                <p>和弦是音乐中不可或缺的元素，通过不同的构成方式和组合，产生数百种不同的类型，为音乐创作提供了几乎无限的可能性。理解和弦的构成、类型和功能，有助于更深入地欣赏音乐，也是作曲、编曲和即兴演奏的基础。</p>
                
                <p>从最基本的三和弦到复杂的扩展和弦，从传统的调性和弦到现代的非传统和弦，和弦理论随着音乐实践不断发展。无论是何种风格的音乐，和弦都在其中扮演着构建音乐结构和表达情感的核心角色。</p>
            </section>
        </main>
    </div>

    <script>
        // 初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            // 和弦介绍图表
            const chordIntroChart = echarts.init(document.getElementById('chord-intro-chart'));
            const chordIntroOption = {
                title: {
                    text: '和弦在不同音乐风格中的应用频率',
                    left: 'center',
                    textStyle: {
                        fontWeight: 'normal'
                    }
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['三和弦', '七和弦', '扩展和弦', '变化和弦'],
                    bottom: '0%'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '12%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['古典音乐', '爵士乐', '流行音乐', '摇滚乐', '电子音乐', '民谣']
                },
                yAxis: {
                    type: 'value',
                    name: '使用频率',
                    max: 100
                },
                series: [
                    {
                        name: '三和弦',
                        type: 'bar',
                        stack: '和弦',
                        emphasis: { focus: 'series' },
                        data: [85, 40, 75, 80, 60, 90]
                    },
                    {
                        name: '七和弦',
                        type: 'bar',
                        stack: '和弦',
                        emphasis: { focus: 'series' },
                        data: [45, 85, 60, 50, 35, 30]
                    },
                    {
                        name: '扩展和弦',
                        type: 'bar',
                        stack: '和弦',
                        emphasis: { focus: 'series' },
                        data: [20, 75, 30, 25, 40, 10]
                    },
                    {
                        name: '变化和弦',
                        type: 'bar',
                        stack: '和弦',
                        emphasis: { focus: 'series' },
                        data: [15, 65, 40, 60, 80, 20]
                    }
                ]
            };
            chordIntroChart.setOption(chordIntroOption);

            // 音程关系图表
            const intervalChart = echarts.init(document.getElementById('interval-chart'));
            const intervalOption = {
                title: {
                    text: '常见音程与半音关系',
                    left: 'center',
                    textStyle: {
                        fontWeight: 'normal'
                    }
                },
                tooltip: {
                    formatter: function(params) {
                        return `${params.name}: ${params.value} 半音`;
                    }
                },
                xAxis: {
                    type: 'category',
                    data: ['小二度', '大二度', '小三度', '大三度', '纯四度', '增四度/减五度', '纯五度', '小六度', '大六度', '小七度', '大七度', '八度']
                },
                yAxis: {
                    type: 'value',
                    name: '半音数',
                    minInterval: 1
                },
                series: [
                    {
                        data: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
                        type: 'bar',
                        itemStyle: {
                            color: function(params) {
                                // 给重要的音程不同颜色
                                const colors = ['#9F7AEA', '#4299E1', '#9F7AEA', '#4299E1', '#48BB78', '#F56565', '#48BB78', '#9F7AEA', '#4299E1', '#9F7AEA', '#4299E1', '#48BB78'];
                                return colors[params.dataIndex];
                            }
                        }
                    }
                ]
            };
            intervalChart.setOption(intervalOption);

            // 和弦统计图表
            const chordStatsChart = echarts.init(document.getElementById('chord-stats-chart'));
            const chordStatsOption = {
                title: {
                    text: '常见和弦类型数量统计',
                    left: 'center',
                    textStyle: {
                        fontWeight: 'normal'
                    }
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left'
                },
                series: [
                    {
                        name: '和弦类型数量',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '18',
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            { value: 4, name: '三和弦' },
                            { value: 7, name: '七和弦' },
                            { value: 12, name: '扩展和弦' },
                            { value: 24, name: '变化和弦' },
                            { value: 48, name: '其他特殊和弦' }
                        ]
                    }
                ]
            };
            chordStatsChart.setOption(chordStatsOption);

            // 和弦进行图表
            const progressionChart = echarts.init(document.getElementById('progression-chart'));
            const progressionOption = {
                title: {
                    text: '常见和弦进行在流行音乐中的使用频率',
                    left: 'center',
                    textStyle: {
                        fontWeight: 'normal'
                    }
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        return `${params[0].name}: ${params[0].value}%`;
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    max: 25
                },
                yAxis: {
                    type: 'category',
                    data: ['I-V-vi-IV', 'I-IV-V', 'vi-IV-I-V', 'I-vi-IV-V', 'ii-V-I', 'i-VI-III-VII', 'I-V-vi-iii-IV', 'I-IV-vi-V'],
                    axisLabel: {
                        interval: 0,
                        rotate: 0
                    }
                },
                series: [
                    {
                        type: 'bar',
                        data: [23, 18, 15, 14, 12, 10, 6, 5],
                        itemStyle: {
                            color: function(params) {
                                const colorList = ['#6B46C1', '#805AD5', '#9F7AEA', '#B794F4', '#D6BCFA', '#E9D8FD', '#FAF5FF', '#F3E8FF'];
                                return colorList[params.dataIndex];
                            }
                        }
                    }
                ]
            };
            progressionChart.setOption(progressionOption);

            // 初始化和弦可视化
            initChordVisuals();
            
            // 初始化互动钢琴
            initInteractivePiano();
            
            // 初始化测验
            initQuiz();
            
            // 窗口调整时重绘图表
            window.addEventListener('resize', function() {
                chordIntroChart.resize();
                intervalChart.resize();
                chordStatsChart.resize();
                progressionChart.resize();
            });
        });
        
        // 和弦可视化
        function initChordVisuals() {
            // 定义基本数据
            const whiteKeys = [0, 2, 4, 5, 7, 9, 11]; // C, D, E, F, G, A, B
            
            // 和弦卡片中钢琴可视化
            function createPianoKeys(container, chord, startNote = 60) { // 60 = 中央C
                const containerEl = document.querySelector(`#${container} .chord-visual`);
                containerEl.innerHTML = '';
                
                // 创建一个八度的琴键
                for (let i = 0; i < 8; i++) {
                    const note = (startNote + i) % 12;
                    const isWhite = whiteKeys.includes(note);
                    
                    const key = document.createElement('div');
                    key.className = isWhite ? 'piano-key white-key' : 'piano-key black-key';
                    
                    // 计算位置
                    if (isWhite) {
                        const whiteIndex = whiteKeys.indexOf(note);
                        key.style.left = `${whiteIndex * 20}px`;
                    } else {
                        // 黑键位置需要特殊计算
                        const prevWhiteIndex = whiteKeys.findIndex(n => n > note);
                        const prevWhite = prevWhiteIndex === -1 ? 6 : prevWhiteIndex - 1;
                        key.style.left = `${prevWhite * 20 + 13}px`;
                    }
                    
                    // 标记活动键
                    if (chord.includes((note - startNote + 12) % 12)) {
                        key.classList.add('key-active');
                    }
                    
                    containerEl.appendChild(key);
                }
            }
            
            // 三和弦
            createPianoKeys('major-triad', [0, 4, 7], 0);
            createPianoKeys('minor-triad', [0, 3, 7], 0);
            createPianoKeys('diminished-triad', [0, 3, 6], 0);
            createPianoKeys('augmented-triad', [0, 4, 8], 0);
            
            // 七和弦
            createPianoKeys('dominant-seventh', [0, 4, 7, 10], 0);
            createPianoKeys('major-seventh', [0, 4, 7, 11], 0);
            createPianoKeys('minor-seventh', [0, 3, 7, 10], 0);
            createPianoKeys('half-diminished', [0, 3, 6, 10], 0);
            createPianoKeys('diminished-seventh', [0, 3, 6, 9], 0);
            createPianoKeys('minor-major-seventh', [0, 3, 7, 11], 0);
            
            // 扩展和弦
            createPianoKeys('ninth-chord', [0, 4, 7, 10, 14 % 12], 0);
            createPianoKeys('eleventh-chord', [0, 4, 7, 10, 14 % 12, 17 % 12], 0);
            createPianoKeys('thirteenth-chord', [0, 4, 7, 10, 14 % 12, 17 % 12, 21 % 12], 0);
            
            // 变化和弦
            createPianoKeys('sus4', [0, 5, 7], 0);
            createPianoKeys('sus2', [0, 2, 7], 0);
            createPianoKeys('add9', [0, 4, 7, 14 % 12], 0);
            createPianoKeys('sixth', [0, 4, 7, 9], 0);
            createPianoKeys('altered-dominant', [0, 4, 6, 10, 13 % 12], 0);
        }
        
        // 互动钢琴
        function initInteractivePiano() {
            const pianoEl = document.getElementById('interactive-piano');
            const chordTypes = {
                'major': { name: '大三和弦', formula: [0, 4, 7] },
                'minor': { name: '小三和弦', formula: [0, 3, 7] },
                'diminished': { name: '减三和弦', formula: [0, 3, 6] },
                'augmented': { name: '增三和弦', formula: [0, 4, 8] },
                'dom7': { name: '属七和弦', formula: [0, 4, 7, 10] },
                'maj7': { name: '大七和弦', formula: [0, 4, 7, 11] },
                'min7': { name: '小七和弦', formula: [0, 3, 7, 10] },
                'sus4': { name: '挂四和弦', formula: [0, 5, 7] },
                'add9': { name: '加九和弦', formula: [0, 4, 7, 14] },
            };
            
            const noteNames = ['C', 'C♯/D♭', 'D', 'D♯/E♭', 'E', 'F', 'F♯/G♭', 'G', 'G♯/A♭', 'A', 'A♯/B♭', 'B'];
            
            // 创建钢琴键
            function createFullPiano() {
                pianoEl.innerHTML = '';
                // 创建两个八度的琴键
                for (let octave = 0; octave < 2; octave++) {
                    for (let i = 0; i < 12; i++) {
                        const note = i;
                        const isWhite = [0, 2, 4, 5, 7, 9, 11].includes(i);
                        
                        const key = document.createElement('div');
                        key.className = isWhite ? 'piano-key white-key' : 'piano-key black-key';
                        key.dataset.note = note + octave * 12;
                        
                        // 计算位置
                        const keyWidth = 20;
                        if (isWhite) {
                            const whiteIndex = [0, 2, 4, 5, 7, 9, 11].indexOf(i);
                            key.style.left = `${(whiteIndex + octave * 7) * keyWidth}px`;
                        } else {
                            const prevWhiteIndex = [0, 2, 4, 5, 7, 9, 11].findIndex(n => n > i);
                            const prevWhite = prevWhiteIndex === -1 ? 6 : prevWhiteIndex - 1;
                            key.style.left = `${(prevWhite + octave * 7) * keyWidth + 13}px`;
                        }
                        
                        pianoEl.appendChild(key);
                    }
                }
            }
            
            createFullPiano();
            
            // 生成和弦
            document.getElementById('build-chord').addEventListener('click', function() {
                const rootNote = parseInt(document.getElementById('root-note').value);
                const chordType = document.getElementById('chord-type').value;
                const inversion = parseInt(document.getElementById('inversion').value);
                
                let formula = [...chordTypes[chordType].formula];
                
                // 应用转位
                if (inversion > 0 && inversion < formula.length) {
                    for (let i = 0; i < inversion; i++) {
                        formula.push(formula.shift() + 12);
                    }
                }
                
                // 计算绝对音符
                const chord = formula.map(interval => (rootNote + interval) % 12);
                
                // 重置所有键的状态
                document.querySelectorAll('#interactive-piano .piano-key').forEach(key => {
                    key.classList.remove('key-active');
                });
                
                // 标记活动键
                chord.forEach(note => {
                    document.querySelectorAll(`#interactive-piano .piano-key[data-note="${note}"], #interactive-piano .piano-key[data-note="${note + 12}"]`).forEach(key => {
                        key.classList.add('key-active');
                    });
                });
                
                // 显示结果
                const inversionNames = ['原位', '第一转位', '第二转位', '第三转位'];
                const chordName = noteNames[rootNote] + getChordSuffix(chordType);
                const notesText = chord.map(n => noteNames[n]).join('-');
                
                document.getElementById('chord-result').innerHTML = `
                    <strong>${chordName}</strong> (${inversionNames[inversion]})
                    <br>组成音: ${notesText}
                    <br>公式: ${getChordFormula(chordType, inversion)}
                `;
            });
            
            function getChordSuffix(type) {
                switch(type) {
                    case 'major': return '';
                    case 'minor': return 'm';
                    case 'diminished': return '°';
                    case 'augmented': return '+';
                    case 'dom7': return '7';
                    case 'maj7': return 'maj7';
                    case 'min7': return 'm7';
                    case 'sus4': return 'sus4';
                    case 'add9': return 'add9';
                    default: return '';
                }
            }
            
            function getChordFormula(type, inversion) {
                const formulas = {
                    'major': ['1-3-5', '3-5-1', '5-1-3'],
                    'minor': ['1-♭3-5', '♭3-5-1', '5-1-♭3'],
                    'diminished': ['1-♭3-♭5', '♭3-♭5-1', '♭5-1-♭3'],
                    'augmented': ['1-3-♯5', '3-♯5-1', '♯5-1-3'],
                    'dom7': ['1-3-5-♭7', '3-5-♭7-1', '5-♭7-1-3', '♭7-1-3-5'],
                    'maj7': ['1-3-5-7', '3-5-7-1', '5-7-1-3', '7-1-3-5'],
                    'min7': ['1-♭3-5-♭7', '♭3-5-♭7-1', '5-♭7-1-♭3', '♭7-1-♭3-5'],
                    'sus4': ['1-4-5', '4-5-1', '5-1-4'],
                    'add9': ['1-3-5-9', '3-5-9-1', '5-9-1-3', '9-1-3-5']
                };
                
                return formulas[type][inversion] || '';
            }
        }
        
        // 测验功能
        function initQuiz() {
            const checkButton = document.getElementById('check-answer');
            const options = document.querySelectorAll('.option');
            const feedback = document.querySelector('.feedback');
            const reward = document.getElementById('reward');
            
            options.forEach(option => {
                option.addEventListener('click', function() {
                    // 清除之前的选择
                    options.forEach(opt => opt.classList.remove('selected'));
                    // 标记当前选择
                    this.classList.add('selected');
                    // 重置反馈
                    feedback.className = 'feedback';
                    feedback.textContent = '';
                    // 隐藏奖励
                    reward.classList.remove('show');
                });
            });
            
            checkButton.addEventListener('click', function() {
                const selected = document.querySelector('.option.selected');
                
                if (!selected) {
                    feedback.className = 'feedback';
                    feedback.textContent = '请选择一个选项';
                    return;
                }
                
                const isCorrect = selected.dataset.correct === 'true';
                
                if (isCorrect) {
                    feedback.className = 'feedback correct';
                    feedback.textContent = '正确！小三和弦由根音、小三度和纯五度组成。';
                    setTimeout(() => {
                        reward.classList.add('show');
                    }, 500);
                } else {
                    feedback.className = 'feedback incorrect';
                    feedback.textContent = '不正确，请再试一次。';
                }
            });
        }
    </script>
</body>
</html>