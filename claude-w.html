<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>和弦基础知识</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
    <style>
        :root {
            --primary: #4f46e5;
            --primary-light: #6366f1;
            --secondary: #2dd4bf;
            --text: #334155;
            --text-light: #64748b;
            --background: #f8fafc;
            --card-bg: rgba(255, 255, 255, 0.7);
            --card-border: rgba(255, 255, 255, 0.2);
            --card-shadow: rgba(0, 0, 0, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text);
            background-color: var(--background);
            background-image: radial-gradient(circle at 70% 20%, rgba(79, 70, 229, 0.1), transparent 400px), 
                             radial-gradient(circle at 30% 70%, rgba(45, 212, 191, 0.1), transparent 400px);
            background-attachment: fixed;
            line-height: 1.6;
            padding: 0;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            position: relative;
            display: flex;
        }
        
        .toc {
            position: sticky;
            top: 2rem;
            width: 250px;
            height: calc(100vh - 4rem);
            overflow-y: auto;
            padding: 1.5rem;
            margin-right: 2rem;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px var(--card-shadow);
            display: block;
        }
        
        @media (max-width: 768px) {
            .toc {
                display: none;
            }
            
            .content {
                width: 100% !important;
            }
        }
        
        .toc h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--primary);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 0.5rem;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc li {
            margin-bottom: 0.5rem;
        }
        
        .toc a {
            text-decoration: none;
            color: var(--text);
            transition: color 0.2s;
            display: block;
            padding: 0.25rem 0;
        }
        
        .toc a:hover {
            color: var(--primary);
        }
        
        .toc .sub-items {
            margin-left: 1rem;
            margin-top: 0.3rem;
            font-size: 0.9rem;
        }
        
        .content {
            width: calc(100% - 250px - 2rem);
        }
        
        h1 {
            font-size: 2.5rem;
            margin: 2rem 0;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        h2 {
            font-size: 1.75rem;
            margin: 2rem 0 1rem;
            color: var(--primary);
            border-bottom: 2px solid rgba(99, 102, 241, 0.2);
            padding-bottom: 0.5rem;
        }
        
        h3 {
            font-size: 1.4rem;
            margin: 1.5rem 0 1rem;
            color: var(--primary-light);
        }
        
        p, li {
            margin-bottom: 1rem;
            line-height: 1.8;
        }
        
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .chart-container {
            height: 400px;
            margin: 2rem 0;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .chord-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .chord-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 12px var(--card-shadow);
            padding: 1.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .chord-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .chord-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        .chord-description {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .piano-diagram {
            margin-top: 1rem;
            background: white;
            border-radius: 8px;
            padding: 0.5rem;
        }
        
        .keyboard {
            display: flex;
            height: 120px;
            position: relative;
        }
        
        .white-key {
            flex: 1;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 0 0 4px 4px;
            position: relative;
        }
        
        .black-key {
            position: absolute;
            width: 65%;
            height: 60%;
            background: #333;
            z-index: 2;
            border-radius: 0 0 4px 4px;
            transform: translateX(-50%);
        }
        
        .note-marker {
            position: absolute;
            bottom: 10px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .chord-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--primary);
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
        }
        
        .quiz-section {
            margin: 3rem 0;
        }
        
        .quiz-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .quiz-options {
            margin: 1.5rem 0;
        }
        
        .quiz-option {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            border: 1px solid var(--card-border);
            transition: all 0.2s;
            cursor: pointer;
            background-color: rgba(255, 255, 255, 0.5);
        }
        
        .quiz-option:hover {
            background-color: rgba(255, 255, 255, 0.8);
            transform: translateX(5px);
        }
        
        .quiz-option.selected {
            background-color: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
        }
        
        .quiz-option.correct {
            background-color: rgba(45, 212, 191, 0.2);
            border-color: var(--secondary);
        }
        
        .quiz-option.wrong {
            background-color: rgba(244, 63, 94, 0.2);
            border-color: #f43f5e;
        }
        
        .feedback {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }
        
        .feedback.correct {
            background-color: rgba(45, 212, 191, 0.2);
            color: #0f766e;
            display: block;
        }
        
        .feedback.wrong {
            background-color: rgba(244, 63, 94, 0.2);
            color: #be123c;
            display: block;
        }
        
        .check-btn {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            display: block;
            margin-top: 1rem;
        }
        
        .check-btn:hover {
            transform: translateY(-2px);
        }
        
        .quiz-reward {
            text-align: center;
            margin-top: 2rem;
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            transform: scale(0.8);
            display: none;
        }
        
        .quiz-reward.show {
            opacity: 1;
            transform: scale(1);
            display: block;
        }
        
        @keyframes gradient {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        .reward-text {
            font-size: 1.2rem;
            font-weight: bold;
            background: linear-gradient(-45deg, #4f46e5, #2dd4bf, #4f46e5);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 5s ease infinite;
        }
        
        .highlight {
            background-color: rgba(99, 102, 241, 0.1);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 2rem 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(203, 213, 225, 0.5);
        }
        
        th {
            background-color: rgba(99, 102, 241, 0.1);
            font-weight: 600;
            color: var(--primary);
        }
        
        tr:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }

        .piano-container {
            position: relative;
            height: 140px;
            margin: 2rem 0;
            user-select: none;
        }
        
        .piano {
            display: flex;
            height: 100%;
        }
        
        .key {
            position: relative;
            cursor: pointer;
        }
        
        .white {
            width: 45px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 0 0 4px 4px;
            height: 100%;
            z-index: 1;
        }
        
        .black {
            width: 30px;
            background: #333;
            height: 60%;
            position: absolute;
            margin-left: -15px;
            z-index: 2;
            border-radius: 0 0 4px 4px;
        }
        
        .key.active {
            background-color: var(--primary-light);
        }
        
        .white .note-label {
            position: absolute;
            bottom: 10px;
            width: 100%;
            text-align: center;
        }
        
        .black .note-label {
            position: absolute;
            bottom: 10px;
            width: 100%;
            text-align: center;
            color: white;
        }
        
        .chord-buttons {
            margin-top: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .chord-button {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--card-border);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chord-button:hover {
            background-color: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="toc">
            <h2>目录</h2>
            <ul>
                <li><a href="#introduction">和弦简介</a></li>
                <li><a href="#basic-concepts">基本概念</a></li>
                <li><a href="#chord-types">和弦的主要类型</a>
                    <ul class="sub-items">
                        <li><a href="#triads">三和弦</a></li>
                        <li><a href="#seventh-chords">七和弦</a></li>
                        <li><a href="#extended-chords">扩展和弦</a></li>
                        <li><a href="#altered-chords">变化和弦</a></li>
                    </ul>
                </li>
                <li><a href="#chord-progressions">和弦进行</a></li>
                <li><a href="#piano-visualization">和弦弹奏示例</a></li>
                <li><a href="#chord-quiz">和弦小测验</a></li>
                <li><a href="#conclusion">总结</a></li>
            </ul>
        </nav>
        
        <div class="content">
            <h1>和弦的世界：理解音乐的和谐结构</h1>
            
            <section id="introduction" class="card">
                <h2>和弦简介</h2>
                <p>和弦是音乐中同时发声的三个或更多个音高不同的音的组合。和弦是西方音乐和声系统的基础，为音乐提供了丰富的色彩和情感表达。无论是古典音乐、爵士乐、摇滚乐还是流行音乐，和弦都扮演着核心角色，定义了音乐的和声结构和情感基调。</p>
                
                <p>和弦既可以用于伴奏，也可以作为旋律的基础。了解和弦的构成、类型和功能，对于理解、创作和演奏音乐都至关重要。在本指南中，我们将探索和弦的世界，从基本的三和弦到复杂的扩展和弦，了解它们的构成、特点和应用。</p>
            </section>
            
            <section id="basic-concepts" class="card">
                <h2>基本概念</h2>
                
                <h3>音程与和弦构成</h3>
                <p>和弦由特定音程关系的音组合而成。音程是两个音之间的距离，最基本的音程单位是<span class="highlight">半音</span>（例如钢琴上相邻的两个键之间的距离）。</p>
                
                <p>和弦的基础是<span class="highlight">三度堆叠</span>，即按照三度音程关系排列音符。例如，最基本的三和弦由根音、三度音和五度音组成。这种三度堆叠的方式形成了和声系统的骨架。</p>
                
                <h3>和弦的命名</h3>
                <p>和弦通常以其<span class="highlight">根音</span>命名，后面加上表示和弦类型的符号或缩写。例如：</p>
                <ul>
                    <li>C大三和弦简写为"C"</li>
                    <li>C小三和弦简写为"Cm"</li>
                    <li>C属七和弦简写为"C7"</li>
                    <li>C小七和弦简写为"Cm7"</li>
                </ul>
                
                <h3>和弦的功能</h3>
                <p>在调性音乐中，和弦具有特定的功能，主要分为<span class="highlight">主和弦（Tonic）</span>、<span class="highlight">属和弦（Dominant）</span>和<span class="highlight">下属和弦（Subdominant）</span>。这些功能赋予音乐张力与释放的动态感，是和声进行的基础。</p>
                
                <div class="chart-container" id="chord-functions"></div>
            </section>
            
            <section id="chord-types" class="card">
                <h2>和弦的主要类型</h2>
                <p>按照构成音的数量和结构，和弦可以分为许多类型，以下是最常见的几种：</p>
                
                <div id="triads" class="subsection">
                    <h3>三和弦</h3>
                    <p>三和弦是最基本的和弦形式，由三个音组成：根音、三度音和五度音。根据三度音和五度音的不同，三和弦分为四种主要类型：</p>
                    
                    <div class="chord-examples">
                        <div class="chord-card">
                            <div class="chord-name">大三和弦 (Major)</div>
                            <div class="chord-description">由根音、大三度和纯五度组成。音符间隔为4-3半音。</div>
                            <div class="chord-description">例如：C大三和弦包括C、E、G</div>
                            <div class="chord-description">特点：明亮、稳定、愉悦</div>
                        </div>
                        
                        <div class="chord-card">
                            <div class="chord-name">小三和弦 (Minor)</div>
                            <div class="chord-description">由根音、小三度和纯五度组成。音符间隔为3-4半音。</div>
                            <div class="chord-description">例如：Cm小三和弦包括C、E♭、G</div>
                            <div class="chord-description">特点：暗淡、忧郁、柔和</div>
                        </div>
                        
                        <div class="chord-card">
                            <div class="chord-name">增三和弦 (Augmented)</div>
                            <div class="chord-description">由根音、大三度和增五度组成。音符间隔为4-4半音。</div>
                            <div class="chord-description">例如：C<sup>+</sup>增三和弦包括C、E、G♯</div>
                            <div class="chord-description">特点：紧张、不稳定、神秘</div>
                        </div>
                        
                        <div class="chord-card">
                            <div class="chord-name">减三和弦 (Diminished)</div>
                            <div class="chord-description">由根音、小三度和减五度组成。音符间隔为3-3半音。</div>
                            <div class="chord-description">例如：C°减三和弦包括C、E♭、G♭</div>
                            <div class="chord-description">特点：不安、紧张、悬疑</div>
                        </div>
                    </div>

                    <div class="chart-container" id="triads-chart"></div>
                </div>
                
                <div id="seventh-chords" class="subsection">
                    <h3>七和弦</h3>
                    <p>七和弦在三和弦的基础上增加了第七个音，这增强了和弦的色彩和功能性。七和弦有多种类型，最常见的包括：</p>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>七和弦类型</th>
                                    <th>构成音</th>
                                    <th>例子(C为根音)</th>
                                    <th>音色特点</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>大七和弦 (Maj7)</td>
                                    <td>根音、大三度、纯五度、大七度</td>
                                    <td>Cmaj7: C-E-G-B</td>
                                    <td>温暖、舒适、梦幻</td>
                                </tr>
                                <tr>
                                    <td>属七和弦 (Dom7)</td>
                                    <td>根音、大三度、纯五度、小七度</td>
                                    <td>C7: C-E-G-B♭</td>
                                    <td>紧张、寻求解决</td>
                                </tr>
                                <tr>
                                    <td>小七和弦 (Min7)</td>
                                    <td>根音、小三度、纯五度、小七度</td>
                                    <td>Cm7: C-E♭-G-B♭</td>
                                    <td>忧郁、柔和、迷人</td>
                                </tr>
                                <tr>
                                    <td>半减七和弦 (m7♭5)</td>
                                    <td>根音、小三度、减五度、小七度</td>
                                    <td>Cm7♭5: C-E♭-G♭-B♭</td>
                                    <td>不安、过渡感</td>
                                </tr>
                                <tr>
                                    <td>减七和弦 (dim7)</td>
                                    <td>根音、小三度、减五度、减七度</td>
                                    <td>C°7: C-E♭-G♭-B♭♭</td>
                                    <td>极度不稳定、紧张</td>
                                </tr>
                                <tr>
                                    <td>小大七和弦 (mM7)</td>
                                    <td>根音、小三度、纯五度、大七度</td>
                                    <td>CmM7: C-E♭-G-B</td>
                                    <td>复杂、忧伤中带明亮</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="extended-chords" class="subsection">
                    <h3>扩展和弦</h3>
                    <p>扩展和弦在七和弦的基础上继续添加音符（九度、十一度、十三度），这些和弦在爵士乐和现代音乐中特别常见，提供了更丰富的和声色彩。</p>
                    
                    <div class="chord-examples">
                        <div class="chord-card">
                            <div class="chord-name">九和弦 (9th)</div>
                            <div class="chord-description">在七和弦的基础上添加九度音。</div>
                            <div class="chord-description">例如：C9包括C、E、G、B♭、D</div>
                        </div>
                        
                        <div class="chord-card">
                            <div class="chord-name">十一和弦 (11th)</div>
                            <div class="chord-description">在九和弦的基础上添加十一度音。</div>
                            <div class="chord-description">例如：C11包括C、E、G、B♭、D、F</div>
                        </div>
                        
                        <div class="chord-card">
                            <div class="chord-name">十三和弦 (13th)</div>
                            <div class="chord-description">在十一和弦的基础上添加十三度音。</div>
                            <div class="chord-description">例如：C13包括C、E、G、B♭、D、F、A</div>
                        </div>
                    </div>

                    <p>扩展和弦通常会省略某些音符以避免过于拥挤或不和谐，特别是在实际演奏中。例如，在十三和弦中，可能会省略十一度或九度音，以使和弦更清晰。</p>
                </div>
                
                <div id="altered-chords" class="subsection">
                    <h3>变化和弦</h3>
                    <p>变化和弦通过改变（升高或降低）和弦中的某些音来创造特殊的和声效果。常见的变化包括：</p>
                    
                    <ul>
                        <li><span class="highlight">sus4和弦</span>：将三度音替换为四度音，例如Csus4包括C、F、G。</li>
                        <li><span class="highlight">sus2和弦</span>：将三度音替换为二度音，例如Csus2包括C、D、G。</li>
                        <li><span class="highlight">add9和弦</span>：在三和弦上添加九度音，但不包含七度音，例如Cadd9包括C、E、G、D。</li>
                        <li><span class="highlight">6和弦</span>：在三和弦上加入六度音，例如C6包括C、E、G、A。</li>
                        <li><span class="highlight">变化五度和弦</span>：如C(♭5)、C(♯5)，通过改变五度音创造不同的色彩。</li>
                    </ul>
                </div>
            </section>
            
            <section id="chord-progressions" class="card">
                <h2>和弦进行</h2>
                <p>和弦进行是指和弦按特定顺序的组合，构成音乐的和声框架。良好的和弦进行能够创造音乐的流动感和情感发展。以下是一些常见的和弦进行：</p>
                
                <div class="chart-container" id="progression-chart"></div>
                
                <h3>经典和弦进行</h3>
                <ul>
                    <li><span class="highlight">I-IV-V</span>：最基本的和弦进行，广泛用于流行音乐、民谣和古典音乐。</li>
                    <li><span class="highlight">I-V-vi-IV</span>：被称为"流行和弦进行"，用于无数流行歌曲。</li>
                    <li><span class="highlight">ii-V-I</span>：爵士乐中的标准进行，创造强烈的和声运动感。</li>
                    <li><span class="highlight">vi-IV-I-V</span>：常见的情感进行，给人温暖且略带忧伤的感觉。</li>
                    <li><span class="highlight">I-vi-IV-V</span>：50年代摇滚经典进行，也称为"Doo-wop进行"。</li>
                </ul>
                
                <p>在不同的调性中，这些和弦进行会使用相应调的和弦。例如，在C大调中，I-IV-V进行为C-F-G；在G大调中则为G-C-D。</p>
            </section>
            
            <section id="piano-visualization" class="card">
                <h2>和弦弹奏示例</h2>
                <p>以下是一个交互式钢琴，可以可视化不同和弦的弹奏方式。点击下方按钮查看不同和弦在钢琴上的位置。</p>
                
                <div class="piano-container">
                    <div class="piano" id="piano">
                        <!-- 钢琴键由JavaScript生成 -->
                    </div>
                </div>
                
                <div class="chord-buttons">
                    <button class="chord-button" data-chord="C">C大三和弦</button>
                    <button class="chord-button" data-chord="Cm">Cm小三和弦</button>
                    <button class="chord-button" data-chord="C7">C7属七和弦</button>
                    <button class="chord-button" data-chord="Cmaj7">Cmaj7大七和弦</button>
                    <button class="chord-button" data-chord="Cm7">Cm7小七和弦</button>
                    <button class="chord-button" data-chord="Cdim">C°减三和弦</button>
                    <button class="chord-button" data-chord="Caug">C+增三和弦</button>
                    <button class="chord-button" data-chord="Csus4">Csus4四级挂留和弦</button>
                </div>
            </section>
            
            <section id="chord-quiz" class="card quiz-section">
                <h2>和弦小测验</h2>
                <p>测试一下你对和弦的理解！选择下面问题的正确答案，然后点击检查结果。</p>
                
                <div class="quiz-card">
                    <h3>问题：以下哪个和弦包含音符C、E、G、B♭？</h3>
                    
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">A. Cmaj7 (C大七和弦)</div>
                        <div class="quiz-option" data-correct="true">B. C7 (C属七和弦)</div>
                        <div class="quiz-option" data-correct="false">C. Cm7 (C小七和弦)</div>
                    </div>
                    
                    <div class="feedback" id="feedback"></div>
                    
                    <button class="check-btn" id="check-btn">检查答案</button>
                </div>
                
                <div class="quiz-reward" id="quiz-reward">
                    <div class="reward-text">恭喜！你已经掌握了和弦的基本知识！</div>
                    <div class="chart-container" id="reward-chart"></div>
                </div>
            </section>
            
            <section id="conclusion" class="card">
                <h2>总结</h2>
                <p>和弦是音乐的基础构建块，通过不同的音符组合创造出丰富多彩的和声效果。从最基本的三和弦到复杂的扩展和弦，每种和弦都有其独特的音色和功能。理解和弦的类型、构成和进行方式，对于作曲、即兴演奏和音乐欣赏都非常重要。</p>
                
                <p>音乐中共有几百种不同的和弦可能性，但掌握基本类型的和弦及其变体，就能应对大多数音乐情境。随着对和弦理解的加深，你会发现音乐的世界更加丰富多彩，并能更好地欣赏和创造音乐作品。</p>
            </section>
        </div>
    </div>

    <script>
        // 初始化ECharts图表
        // 和弦功能图表
        const chordFunctionsChart = echarts.init(document.getElementById('chord-functions'));
        const chordFunctionsOption = {
            title: {
                text: '主要和弦功能及情感特性',
                left: 'center',
                textStyle: {
                    color: '#4f46e5'
                }
            },
            tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b}: {c}'
            },
            legend: {
                data: ['稳定性', '情感色彩', '常见于'],
                bottom: 10
            },
            series: [
                {
                    name: '和弦功能',
                    type: 'graph',
                    layout: 'circular',
                    circular: {
                        rotateLabel: true
                    },
                    data: [
                        {
                            name: 'I (主和弦)',
                            value: '最稳定，表示归属感和解决',
                            symbolSize: 60,
                            itemStyle: {
                                color: '#4f46e5'
                            }
                        },
                        {
                            name: 'V (属和弦)',
                            value: '不稳定，创造张力，寻求解决',
                            symbolSize: 60,
                            itemStyle: {
                                color: '#2dd4bf'
                            }
                        },
                        {
                            name: 'IV (下属和弦)',
                            value: '半稳定，柔和过渡',
                            symbolSize: 60,
                            itemStyle: {
                                color: '#8b5cf6'
                            }
                        },
                        {
                            name: 'vi (副属和弦)',
                            value: '相对稳定，忧伤色彩',
                            symbolSize: 50,
                            itemStyle: {
                                color: '#f59e0b'
                            }
                        },
                        {
                            name: 'ii (副下属和弦)',
                            value: '不太稳定，常作为过渡',
                            symbolSize: 50,
                            itemStyle: {
                                color: '#ec4899'
                            }
                        }
                    ],
                    links: [
                        {source: 'V (属和弦)', target: 'I (主和弦)'},
                        {source: 'IV (下属和弦)', target: 'I (主和弦)'},
                        {source: 'IV (下属和弦)', target: 'V (属和弦)'},
                        {source: 'ii (副下属和弦)', target: 'V (属和弦)'},
                        {source: 'vi (副属和弦)', target: 'IV (下属和弦)'},
                        {source: 'I (主和弦)', target: 'vi (副属和弦)'}
                    ],
                    lineStyle: {
                        opacity: 0.9,
                        width: 2,
                        curveness: 0.2
                    },
                    label: {
                        show: true,
                        position: 'right',
                        formatter: '{b}'
                    },
                    emphasis: {
                        lineStyle: {
                            width: 4
                        }
                    }
                }
            ]
        };
        chordFunctionsChart.setOption(chordFunctionsOption);
        
        // 三和弦对比图表
        const triadsChart = echarts.init(document.getElementById('triads-chart'));
        const triadsOption = {
            title: {
                text: '四种基本三和弦结构对比',
                left: 'center',
                textStyle: {
                    color: '#4f46e5'
                }
            },
            tooltip: {
                trigger: 'axis',
                formatter: function(params) {
                    let result = params[0].name + '<br/>';
                    params.forEach(param => {
                        result += param.marker + param.seriesName + ': ' + param.value + '半音<br/>';
                    });
                    return result;
                }
            },
            legend: {
                data: ['第一音程', '第二音程'],
                bottom: 10
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: ['大三和弦', '小三和弦', '增三和弦', '减三和弦'],
                axisLine: {
                    lineStyle: {
                        color: '#4f46e5'
                    }
                }
            },
            yAxis: {
                type: 'value',
                name: '半音数',
                axisLabel: {
                    formatter: '{value}'
                }
            },
            series: [
                {
                    name: '第一音程',
                    type: 'bar',
                    data: [4, 3, 4, 3],
                    itemStyle: {
                        color: '#4f46e5'
                    }
                },
                {
                    name: '第二音程',
                    type: 'bar',
                    data: [3, 4, 4, 3],
                    itemStyle: {
                        color: '#2dd4bf'
                    }
                }
            ]
        };
        triadsChart.setOption(triadsOption);
        
        // 和弦进行图表
        const progressionChart = echarts.init(document.getElementById('progression-chart'));
        const progressionOption = {
            title: {
                text: '常见和弦进行在流行音乐中的使用频率',
                left: 'center',
                textStyle: {
                    color: '#4f46e5'
                }
            },
            tooltip: {
                trigger: 'item'
            },
            legend: {
                bottom: 10,
                left: 'center',
                data: ['非常常见', '常见', '较常见', '特殊用途']
            },
            series: [
                {
                    name: '使用频率',
                    type: 'pie',
                    radius: ['35%', '70%'],
                    center: ['50%', '50%'],
                    roseType: 'area',
                    itemStyle: {
                        borderRadius: 8
                    },
                    label: {
                        formatter: '{b}: {c}%'
                    },
                    data: [
                        {value: 25, name: 'I-IV-V', itemStyle: {color: '#4f46e5'}},
                        {value: 22, name: 'I-V-vi-IV', itemStyle: {color: '#6366f1'}},
                        {value: 18, name: 'ii-V-I', itemStyle: {color: '#2dd4bf'}},
                        {value: 15, name: 'vi-IV-I-V', itemStyle: {color: '#0ea5e9'}},
                        {value: 12, name: 'I-vi-IV-V', itemStyle: {color: '#8b5cf6'}},
                        {value: 8, name: 'I-IV-vi-V', itemStyle: {color: '#f59e0b'}}
                    ],
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        progressionChart.setOption(progressionOption);
        
        // 创建交互式钢琴
        const piano = document.getElementById('piano');
        const keys = [
            {note: 'C', type: 'white', keyCode: 'KeyA'},
            {note: 'C♯/D♭', type: 'black', keyCode: 'KeyW'},
            {note: 'D', type: 'white', keyCode: 'KeyS'},
            {note: 'D♯/E♭', type: 'black', keyCode: 'KeyE'},
            {note: 'E', type: 'white', keyCode: 'KeyD'},
            {note: 'F', type: 'white', keyCode: 'KeyF'},
            {note: 'F♯/G♭', type: 'black', keyCode: 'KeyT'},
            {note: 'G', type: 'white', keyCode: 'KeyG'},
            {note: 'G♯/A♭', type: 'black', keyCode: 'KeyY'},
            {note: 'A', type: 'white', keyCode: 'KeyH'},
            {note: 'A♯/B♭', type: 'black', keyCode: 'KeyU'},
            {note: 'B', type: 'white', keyCode: 'KeyJ'},
            {note: 'C', type: 'white', keyCode: 'KeyK'}
        ];
        
        // 构建钢琴键
        let blackKeyIndex = 0;
        for (let i = 0; i < keys.length; i++) {
            const key = document.createElement('div');
            key.className = `key ${keys[i].type}`;
            key.dataset.note = keys[i].note;
            
            const noteLabel = document.createElement('div');
            noteLabel.className = 'note-label';
            noteLabel.textContent = keys[i].note;
            key.appendChild(noteLabel);
            
            piano.appendChild(key);
            
            if (keys[i].type === 'black') {
                key.style.left = `${blackKeyIndex * 45 + 30}px`;
                blackKeyIndex++;
            }
            
            if (keys[i].type === 'white') {
                blackKeyIndex++;
            }
        }
        
        // 和弦定义
        const chords = {
            'C': [0, 4, 7], // C-E-G
            'Cm': [0, 3, 7], // C-E♭-G
            'C7': [0, 4, 7, 10], // C-E-G-B♭
            'Cmaj7': [0, 4, 7, 11], // C-E-G-B
            'Cm7': [0, 3, 7, 10], // C-E♭-G-B♭
            'Cdim': [0, 3, 6], // C-E♭-G♭
            'Caug': [0, 4, 8], // C-E-G♯
            'Csus4': [0, 5, 7] // C-F-G
        };
        
        // 为和弦按钮添加事件监听
        document.querySelectorAll('.chord-button').forEach(button => {
            button.addEventListener('click', function() {
                // 清除所有键的高亮状态
                document.querySelectorAll('.key').forEach(key => key.classList.remove('active'));
                
                const chordName = this.getAttribute('data-chord');
                const chordNotes = chords[chordName];
                
                if (chordNotes) {
                    // 为和弦中的音符添加高亮
                    chordNotes.forEach(noteOffset => {
                        const noteIndex = noteOffset % 12;
                        const keyElements = document.querySelectorAll('.key');
                        
                        for (let i = 0; i < keyElements.length; i++) {
                            const keyNote = keyElements[i].dataset.note;
                            const noteMap = {
                                'C': 0, 'C♯/D♭': 1, 'D': 2, 'D♯/E♭': 3, 'E': 4,
                                'F': 5, 'F♯/G♭': 6, 'G': 7, 'G♯/A♭': 8, 'A': 9,
                                'A♯/B♭': 10, 'B': 11
                            };
                            
                            if (noteMap[keyNote] === noteIndex) {
                                keyElements[i].classList.add('active');
                                break;
                            }
                        }
                    });
                }
            });
        });
        
        // 测验互动功能
        const checkBtn = document.getElementById('check-btn');
        const feedbackEl = document.getElementById('feedback');
        const quizReward = document.getElementById('quiz-reward');
        
        checkBtn.addEventListener('click', function() {
            const selectedOption = document.querySelector('.quiz-option.selected');
            if (!selectedOption) {
                feedbackEl.textContent = '请选择一个选项';
                feedbackEl.className = 'feedback';
                return;
            }
            
            const isCorrect = selectedOption.getAttribute('data-correct') === 'true';
            
            if (isCorrect) {
                feedbackEl.textContent = '正确！C7属七和弦由根音C、大三度E、纯五度G和小七度B♭组成。';
                feedbackEl.className = 'feedback correct';
                selectedOption.classList.add('correct');
                
                // 显示奖励图表
                quizReward.classList.add('show');
                
                // 初始化奖励图表
                const rewardChart = echarts.init(document.getElementById('reward-chart'));
                const rewardOption = {
                    title: {
                        text: 'C7和弦的构成',
                        left: 'center',
                        textStyle: {
                            color: '#4f46e5'
                        }
                    },
                    series: [
                        {
                            type: 'gauge',
                            startAngle: 90,
                            endAngle: -270,
                            pointer: {
                                show: false
                            },
                            progress: {
                                show: true,
                                overlap: false,
                                roundCap: true,
                                clip: false,
                                itemStyle: {
                                    borderWidth: 1,
                                    borderColor: '#464646'
                                }
                            },
                            axisLine: {
                                lineStyle: {
                                    width: 40
                                }
                            },
                            splitLine: {
                                show: false,
                                distance: 0,
                                length: 10
                            },
                            axisTick: {
                                show: false
                            },
                            axisLabel: {
                                show: false,
                                distance: 50
                            },
                            data: [
                                {
                                    value: 25,
                                    name: 'C (根音)',
                                    title: {
                                        offsetCenter: ['0%', '-10%']
                                    },
                                    detail: {
                                        offsetCenter: ['0%', '10%']
                                    },
                                    itemStyle: {
                                        color: '#4f46e5'
                                    }
                                },
                                {
                                    value: 25,
                                    name: 'E (大三度)',
                                    title: {
                                        offsetCenter: ['0%', '-10%']
                                    },
                                    detail: {
                                        offsetCenter: ['0%', '10%']
                                    },
                                    itemStyle: {
                                        color: '#2dd4bf'
                                    }
                                },
                                {
                                    value: 25,
                                    name: 'G (纯五度)',
                                    title: {
                                        offsetCenter: ['0%', '-10%']
                                    },
                                    detail: {
                                        offsetCenter: ['0%', '10%']
                                    },
                                    itemStyle: {
                                        color: '#f59e0b'
                                    }
                                },
                                {
                                    value: 25,
                                    name: 'B♭ (小七度)',
                                    title: {
                                        offsetCenter: ['0%', '-10%']
                                    },
                                    detail: {
                                        offsetCenter: ['0%', '10%']
                                    },
                                    itemStyle: {
                                        color: '#8b5cf6'
                                    }
                                }
                            ],
                            title: {
                                fontSize: 14
                            },
                            detail: {
                                width: 50,
                                height: 14,
                                fontSize: 14,
                                color: 'auto',
                                borderColor: 'auto',
                                borderRadius: 20,
                                borderWidth: 1,
                                formatter: '{value}%'
                            }
                        }
                    ]
                };
                rewardChart.setOption(rewardOption);
            } else {
                feedbackEl.textContent = '不正确。C7属七和弦由根音C、大三度E、纯五度G和小七度B♭组成。';
                feedbackEl.className = 'feedback wrong';
                selectedOption.classList.add('wrong');
                
                // 标记正确答案
                document.querySelectorAll('.quiz-option').forEach(option => {
                    if (option.getAttribute('data-correct') === 'true') {
                        option.classList.add('correct');
                    }
                });
            }
        });
        
        // 为测验选项添加事件监听
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                // 清除所有选择
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // 选中当前选项
                this.classList.add('selected');
                
                // 重置反馈
                feedbackEl.className = 'feedback';
                feedbackEl.textContent = '';
            });
        });
        
        // 响应式调整
        window.addEventListener('resize', function() {
            chordFunctionsChart.resize();
            triadsChart.resize();
            progressionChart.resize();
            if (document.getElementById('reward-chart') && document.getElementById('quiz-reward').classList.contains('show')) {
                echarts.getInstanceByDom(document.getElementById('reward-chart')).resize();
            }
        });
    </script>
</body>
</html>