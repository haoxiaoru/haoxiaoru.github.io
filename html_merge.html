<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML 代码合成工具</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        #processBtn {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: #3498db;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #processBtn:hover {
            background-color: #2980b9;
        }
        #processBtn:disabled {
            background-color: #a9cce3;
            cursor: not-allowed;
        }
        .editor-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .editor-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 18px;
        }
        textarea {
            width: 100%;
            height: 60vh;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            font-family: "Courier New", Courier, monospace;
            font-size: 14px;
            line-height: 1.5;
            box-sizing: border-box;
            resize: vertical;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            font-size: 16px;
            display: none; /* Hidden by default */
        }
        #status.success {
            background-color: #e8f5e9;
            color: #2e7d32;
            display: block;
        }
        #status.error {
            background-color: #fce4e4;
            color: #c62828;
            display: block;
        }
        #status ul {
            list-style-type: none;
            padding: 0;
            margin-top: 10px;
            text-align: left;
            max-height: 150px;
            overflow-y: auto;
            background: #fff;
            padding: 10px;
            border: 1px solid #c62828;
        }
        #status li {
            font-family: "Courier New", Courier, monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-break: break-all;
            padding: 5px;
            border-bottom: 1px dashed #ddd;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>HTML 代码合成工具</h1>
        <p style="text-align: center; color: #555;">将原始HTML代码和变更要求粘贴到下方，点击按钮即可合成新的HTML文件并下载。</p>

        <div class="editor-container">
            <div class="editor-pane">
                <label for="originalHtml">1. 原始 HTML 代码</label>
                <textarea id="originalHtml" placeholder="在此处粘贴你的原始HTML代码..."></textarea>
            </div>
            <div class="editor-pane">
                <label for="codeChanges">2. Code Change 要求</label>
                <textarea id="codeChanges" placeholder="在此处粘贴变更要求..."><![CDATA[/index.html
<<<<<<< SEARCH
                        <p class="text-xl text-white/90 mb-8 leading-relaxed">
                            一个上海8岁男孩在自然教育活动中因接触泥土而恐惧哭泣的故事，据称记录在《2023年中国儿童自然教育白皮书》中，却在网络世界中无迹可寻。
                        </p>
=======
                        <p class="text-xl text-white/90 mb-8 leading-relaxed">
                            一个上海8岁男孩在自然教育活动中因首次接触泥土而感到恐惧并哭泣，声称“脏东西会让我生病”。这个据称记录在《2023年中国儿童自然教育白皮书》中的故事，在网络世界中却无迹可寻，引发了本次深度调查。
                        </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                    <p class="text-gray-700 leading-relaxed mb-6">
                        根据用户提供的信息，核心事件为一名上海8岁男孩在参与自然教育活动时，因首次接触泥土而感到恐惧并哭泣，并声称"脏东西会让我生病"。该事件据称被记录在2023年发布的《中国儿童自然教育白皮书》中。
                    </p>
=======
                    <p class="text-gray-700 leading-relaxed mb-6">
                        根据用户提供的信息，核心事件为一名上海8岁男孩在参与自然教育活动时，因首次接触泥土而感到恐惧并哭泣，并声称“脏东西会让我生病”。该事件据称被记录在2023年发布的《中国儿童自然教育白皮书》中。这一事件揭示了当前儿童，特别是城市儿童，在自然接触方面可能存在的障碍和心理问题。自然教育旨在引导儿童亲近自然，培养其环保意识，但此案例却揭示了部分儿童在接触自然时可能出现的负面情绪反应，这可能与城市生活、家长过度保护等多种因素有关。
                    </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <ul class="text-sm space-y-1 text-gray-600">
                                    <li>• 上海 8岁男孩 自然教育活动 泥土 恐惧</li>
                                    <li>• 中国儿童自然教育白皮书 2023</li>
                                    <li>• 脏东西会让我生病 上海 8岁男孩</li>
                                    <li>• 自然教育活动 孩子 恐惧 泥土</li>
                                </ul>
=======
                                <ul class="text-sm space-y-1 text-gray-600">
                                    <li>• 上海 8岁男孩 自然教育活动 泥土 恐惧</li>
                                    <li>• 《中国儿童自然教育白皮书（2023）》 全文</li>
                                    <li>• 脏东西会让我生病 上海 8岁男孩</li>
                                    <li>• 自然教育活动 孩子 恐惧 泥土</li>
                                    <li>• 2023年 自然教育 白皮书 中国 儿童 土壤恐惧</li>
                                </ul>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <ul class="text-sm space-y-1 text-gray-600">
                                    <li>• China children nature education white paper 2023</li>
                                    <li>• Shanghai 8-year-old boy nature education soil fear</li>
                                    <li>• Nature education white paper China 2023 Shanghai</li>
                                    <li>• Shanghai children nature education fear of soil</li>
                                </ul>
=======
                                <ul class="text-sm space-y-1 text-gray-600">
                                    <li>• China children nature education white paper 2023 Shanghai</li>
                                    <li>• Shanghai 8-year-old boy nature education soil fear</li>
                                    <li>• 2023 China child nature education white paper report</li>
                                    <li>• Shanghai children nature education fear of soil</li>
                                    <li>• China Children's Nature Education White Paper 2023 Shanghai</li>
                                </ul>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                        <p class="text-gray-700">
                            这些描述与上海8岁男孩对泥土的恐惧和"脏东西会让我生病"的认知在核心行为和心理反应上具有高度的相似性。
                        </p>
=======
                        <p class="text-gray-700">
                            这些描述与上海8岁男孩对泥土的恐惧和"脏东西会让我生病"的认知在核心行为和心理反应上具有高度的相似性。该文章将这种现象归因于“人与自然的疏离”，并引用了美国作家理查德·洛夫提出的“自然缺失症”概念。
                        </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-sm text-gray-600">一位自然教育者梁哲涛回忆，在雨后的草地课上，一个小女孩突然哭了起来，说地面很脏，与她习惯的水泥、木头和瓷砖地面不同。</p>
=======
                                <p class="text-sm text-gray-600">一位在北京从事自然教育六年的教育者梁哲涛回忆，在一次雨后的草地课上，一个小女孩突然哭了起来，说地面很脏，这与她习惯的水泥、木头和瓷砖地面不同。梁认为这是他第一次如此清晰地看到“自然缺失症”的迹象。</p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-sm text-gray-600">即使在徒步旅行后筋疲力尽，一些孩子也因为认为地面脏而拒绝坐在地上；他们害怕泥土、昆虫和虫子。</p>
=======
                                <p class="text-sm text-gray-600">即使在徒步旅行后筋疲力尽，一些孩子也因为认为地面脏而拒绝坐在地上。他们害怕泥土、昆虫和虫子，曾有孩子因被蚂蚁吓到而惊慌地打电话喊“救命！”。</p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-blue-800 text-sm">
                                    <strong>何女士（普陀区）：</strong>她儿子每周只有一节自然课，且从未在学校进行过户外课程。曾考虑报名观察萤火虫的夜行活动，但因天气炎热被儿子拒绝。
                                </p>
=======
                                <p class="text-blue-800 text-sm">
                                    <strong>何女士（普陀区）：</strong>她儿子每周只有一节自然课，且从未在学校进行过户外课程。她提到儿子是独生子女，在疫情期间经常独自在家，导致对电子屏幕的依赖加剧。曾考虑报名观察萤火虫的夜行活动，但因天气炎热被儿子拒绝。
                                </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-green-800 text-sm">
                                    <strong>张女士：</strong>她儿子每周有两节自然课，但由语文老师任教，更侧重于地质学和物理学的基本原理，而非动手实践。
                                </p>
=======
                                <p class="text-green-800 text-sm">
                                    <strong>张女士：</strong>她儿子每周有两节自然课，但由语文老师任教，课程内容更侧重于地质学和物理学的基本原理等科学概念，而非动手实践。学校从未专门讨论过自然教育，家长对此也了解不多。
                                </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <h4 class="font-semibold text-orange-800 mb-2">华东师大田野调查</h4>
                                <p class="text-orange-700 text-sm">76%的儿童出现"自然恐惧症"（害怕昆虫/抗拒泥土接触）<a href="https://www.sohu.com/a/879019328_121924581" class="citation"><sup>[495]</sup></a></p>
=======
                                <h4 class="font-semibold text-orange-800 mb-2">华东师大田野调查</h4>
                                <p class="text-orange-700 text-sm">在一次田野调查中发现，长期被要求模仿哲思写作的孩子中，76%出现"自然恐惧症"（害怕昆虫/抗拒泥土接触）<a href="https://www.sohu.com/a/879019328_121924581" class="citation"><sup>[495]</sup></a></p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>• 创造力下降</li>
                                        <li>• 想象力缺乏</li>
                                        <li>• 自然知识匮乏</li>
                                        <li>• 对自然冷漠恐惧</li>
                                    </ul>
=======
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>• 创造力下降</li>
                                        <li>• 想象力缺乏</li>
                                        <li>• 自然知识匮乏</li>
                                        <li>• 对自然冷漠或恐惧</li>
                                    </ul>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                        <p class="text-gray-700 mb-4">
                            研究显示<a href="https://pdf.hanspub.org/ae20230400000_30380500.pdf" class="citation"><sup>[484,486]</sup></a>，家长的教育焦虑是导致学生对大自然产生恐惧的重要因素：
                        </p>
=======
                        <p class="text-gray-700 mb-4">
                            研究显示<a href="https://pdf.hanspub.org/ae20230400000_30380500.pdf" class="citation"><sup>[484,486]</sup></a>，家长的教育焦虑是导致学生对大自然产生恐惧的重要因素。因担心“脏”和“危险”而阻止孩子接触自然，导致孩子对自然不了解，进而产生恐惧，形成恶性循环。
                        </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                        <p class="text-red-700">
                            尽管用户问题明确指出事件源自2023年《中国儿童自然教育白皮书》，但在多次搜索尝试中，未能找到关于这份特定白皮书的任何直接信息，包括其全文、官方发布渠道或相关的新闻报道。
                        </p>
=======
                        <p class="text-red-700">
                            尽管用户问题明确指出事件源自2023年《中国儿童自然教育白皮书》，但在多次搜索尝试中，未能找到关于这份特定白皮书的任何直接信息，包括其全文、官方发布渠道或相关的新闻报道。如果该白皮书确实存在且包含此案例，那么其未公开或公开范围有限是导致无法找到报道链接的主要原因。
                        </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <h4 class="font-semibold text-primary mb-2">《2023中国自然教育行业发展报告》</h4>
                                <p class="text-sm text-gray-600 mb-2">
                                    北京师范大学发布的行业发展报告<a href="https://news.qq.com/rain/a/20240525A0623000" class="citation"><sup>[261]</sup></a>
                                </p>
                                <p class="text-xs text-gray-500">注：侧重行业数据，非儿童案例研究</p>
=======
                                <h4 class="font-semibold text-primary mb-2">《2023中国自然教育行业发展报告》</h4>
                                <p class="text-sm text-gray-600 mb-2">
                                    由北京师范大学教授黄宇在“2024中国自然教育大会”上发布<a href="https://news.qq.com/rain/a/20240525A0623000" class="citation"><sup>[261]</sup></a>。报告显示，2023年全国自然教育机构达21,556家，同比增长34.15%。服务对象以中青年家庭为主，活动类型多为自然科普、农耕体验等。
                                </p>
                                <p class="text-xs text-gray-500">注：侧重行业宏观数据，但揭示了时间、距离和安全是公众参与的主要障碍。</p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《未成年人检察工作白皮书（2023）》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">最高人民检察院</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">间接相关</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《中国智慧教育白皮书》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">教育部</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">教育相关</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《新时代的中国绿色发展》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">国务院新闻办</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">环境相关</td>
                                    </tr>
=======
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《未成年人检察工作白皮书（2023）》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">最高人民检察院</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">不相关（法律保护）</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《中国智慧教育白皮书》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">教育部</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">不相关（科技教育）</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《新时代的中国绿色发展》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">国务院新闻办</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">不相关（宏观政策）</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">《上海儿童友好城市建设案例集2023》</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">上海市</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">不相关（城市建设）</td>
                                    </tr>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-gray-700">
                                    <strong>白皮书存疑：</strong>《2023年中国儿童自然教育白皮书》的存在性和公开性未能通过当前搜索结果得到证实。
                                </p>
=======
                                <p class="text-gray-700">
                                    <strong>白皮书存疑：</strong>《2023年中国儿童自然教育白皮书》的存在性和公开性未能通过当前搜索结果得到证实。不能排除该文件为内部资料或未广泛公开发布的可能性。
                                </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <p class="text-gray-700">
                                    <strong>现象真实存在：</strong>类似的儿童对自然环境恐惧的现象在中国确实存在，并有多项研究和案例支持。
                                </p>
=======
                                <p class="text-gray-700">
                                    <strong>现象真实存在：</strong>虽然具体案例无法证实，但儿童对自然环境（尤其是泥土、昆虫）的恐惧现象在中国确实存在，并有深圳、北京、福州等多地案例及华东师范大学的调查数据<a href="https://www.sohu.com/a/879019328_121924581" class="citation"><sup>[495]</sup></a>予以佐证。
                                </p>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                                <ul class="text-blue-700 text-sm space-y-2">
                                    <li>• 事件可能未被主流媒体关注</li>
                                    <li>• 白皮书可能未公开发布</li>
                                    <li>• 信息传播渠道有限</li>
                                    <li>• 搜索策略存在局限性</li>
                                </ul>
=======
                                <ul class="text-blue-700 text-sm space-y-2">
                                    <li>• <strong>媒体未关注：</strong>该事件可能被视为个案，未引起主流媒体的报道兴趣。</li>
                                    <li>• <strong>白皮书未公开：</strong>报告可能为内部文件或仅在小范围传播，未公开发布。</li>
                                    <li>• <strong>信息融合：</strong>用户记忆中的事件可能是将多个类似案例（如深圳、北京案例）融合成了“上海8岁男孩”这一具体形象。</li>
                                    <li>• <strong>搜索局限：</strong>尽管策略多样，仍可能存在无法触及的信息孤岛。</li>
                                </ul>
>>>>>>> REPLACE
/index.html
<<<<<<< SEARCH
                        <p class="leading-relaxed">
                            虽然我们未能找到关于上海8岁男孩具体案例的直接报道，但这次调查揭示了一个更深层的问题：中国儿童与自然日益疏离的现象确实存在，并且比我们想象的更为普遍。无论这个特定的故事是否真实，它所反映的问题值得整个社会的关注和思考。
                        </p>
=======
                        <p class="leading-relaxed">
                            虽然我们未能找到关于上海8岁男孩具体案例的直接报道，但本次调查清晰地揭示了一个更深层的问题：中国儿童与自然日益疏离的“自然缺失症”现象确实存在，并且比我们想象的更为普遍。无论这个特定的故事是否为真实记录，它作为一个强有力的符号，所反映出的城市化进程中儿童成长环境的变迁、教育观念的偏差等问题，都值得整个社会的深刻关注和系统性反思。
                        </p>
>>>>>>> REPLACE]]></textarea>
            </div>
        </div>

        <div class="controls">
            <button id="processBtn">合成并下载</button>
        </div>

        <div id="status"></div>
    </div>

    <script>
        document.getElementById('processBtn').addEventListener('click', function() {
            const processBtn = this;
            const originalHtmlInput = document.getElementById('originalHtml');
            const codeChangesInput = document.getElementById('codeChanges');
            const statusDiv = document.getElementById('status');
            
            // 重置状态
            statusDiv.style.display = 'none';
            statusDiv.className = '';
            statusDiv.innerHTML = '';
            processBtn.disabled = true;
            processBtn.textContent = '处理中...';

            let originalHtml = originalHtmlInput.value;
            const codeChanges = codeChangesInput.value;

            if (!originalHtml.trim() || !codeChanges.trim()) {
                showStatus('错误：原始HTML代码和Code Change要求都不能为空！', 'error');
                resetButton();
                return;
            }

            // 使用正则表达式解析所有变更块
            const changeBlockRegex = /(?:^\/.*$\r?\n)?<<<<<<< SEARCH\s*([\s\S]*?)\s*=======\s*([\s\S]*?)\s*>>>>>>> REPLACE/gm;
            const matches = [...codeChanges.matchAll(changeBlockRegex)];

            if (matches.length === 0) {
                showStatus('错误：未能从Code Change要求中解析出任何有效的变更块。请检查格式。', 'error');
                resetButton();
                return;
            }

            let modifiedHtml = originalHtml;
            let successfulReplacements = 0;
            const failedSearches = [];

            matches.forEach((match, index) => {
                // match[1] 是 SEARCH 块, match[2] 是 REPLACE 块
                const searchText = match[1].trim();
                const replaceText = match[2].trim();

                // 检查原始文本中是否包含要搜索的片段
                if (modifiedHtml.includes(searchText)) {
                    // 只替换第一个匹配项，这符合diff/patch的典型行为
                    modifiedHtml = modifiedHtml.replace(searchText, replaceText);
                    successfulReplacements++;
                } else {
                    failedSearches.push({ index: index + 1, text: searchText });
                }
            });

            // 提供处理结果反馈
            let statusMessage = `处理完成！总共 ${matches.length} 个变更请求。<br><strong>${successfulReplacements} 个成功替换。</strong>`;
            if (failedSearches.length > 0) {
                statusMessage += `<br><strong style="color: #c62828;">${failedSearches.length} 个片段未在原始HTML中找到：</strong>`;
                let failedList = '<ul>';
                failedSearches.forEach(failed => {
                    failedList += `<li><strong>#${failed.index}:</strong> <code>${escapeHtml(failed.text.substring(0, 200))}...</code></li>`;
                });
                failedList += '</ul>';
                statusMessage += failedList;
                showStatus(statusMessage, 'error');
            } else {
                showStatus(statusMessage, 'success');
            }
            
            // 如果至少有一个替换成功，则提供下载
            if (successfulReplacements > 0 || (matches.length > 0 && failedSearches.length < matches.length)) {
                downloadFile(modifiedHtml, 'modified_page.html', 'text/html');
            }

            resetButton();
        });

        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = message;
            statusDiv.className = type;
            statusDiv.style.display = 'block';
        }

        function resetButton() {
            const processBtn = document.getElementById('processBtn');
            processBtn.disabled = false;
            processBtn.textContent = '合成并下载';
        }

        function downloadFile(content, fileName, contentType) {
            const a = document.createElement("a");
            const file = new Blob([content], { type: contentType });
            a.href = URL.createObjectURL(file);
            a.download = fileName;
            document.body.appendChild(a); // Required for Firefox
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
        }
        
        function escapeHtml(unsafe) {
            return unsafe
                 .replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;")
                 .replace(/'/g, "&#039;");
        }
    </script>

</body>
</html>